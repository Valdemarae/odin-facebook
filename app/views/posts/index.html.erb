<h1>Posts</h1>
<h2><%= button_to 'Create Post', new_post_path, method: :get %></h2>

<ul>
  <% @posts.each do |post| %>
    <li>
      <h3>
        <%= post.creator.name %>'s post (likes count: <%= post.likes.count %>)

        <% if (post.creator.id == current_user.id) %>
          <%= button_to 'Edit Post', edit_post_path(post.id), method: :get %>
        <% end %>

      </h3> 
      <h4><%= post.content %></h4>

      <% if (post.likes.exists?(user_id: current_user.id)) %>
        <%= button_to 'Unlike', like_path(Like.find_by(post_id: post.id).id), method: :delete %>
      <% else %>
        <%= button_to 'Like', likes_path, params: { like: { user_id: current_user.id, post_id: post.id } } %>
      <% end %>

      <% if (post.comments.any?) %>
        <h3>Comments</h3>
        <% post.comments.each do |comment| %>
          <h4><%= comment.creator.name %></h4>
          <p><%= comment.content %></p>
        <% end %>
      <% end %>

      <%= form_with model: Comment.new do |f| %>
        <%= f.hidden_field :creator_id, value: current_user.id %>
        <%= f.hidden_field :post_id, value: post.id %>

        <%= f.text_field :content %>

        <%= f.submit %>
      <% end %>
        
    </li>
  <% end %>
</ul>

<%= button_to "logout", destroy_user_session_path, method: :delete  %>